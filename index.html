<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NxtHyre - Professional Recruitment Platform</title>
    <meta
      name="description"
      content="Streamline your recruitment process with NxtHyre's advanced candidate filtering and management system."
    />
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
    <script>
      (function (d, t) {
        var BASE_URL = "https://help.nxthyre.com";
        var g = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
        g.src = BASE_URL + "/packs/js/sdk.js";
        g.async = true;
        s.parentNode.insertBefore(g, s);
        g.onload = function () {
          window.chatwootSDK.run({
            websiteToken: "was9T3JGVkjYgNcPuDhXsbHm",
            baseUrl: BASE_URL,
          });
        };
      })(document, "script");

      window.addEventListener("chatwoot:ready", function () {
        // Function to get user data from sessionStorage
        function getUserFromSessionStorage() {
          const key =
            "firebase:authUser:AIzaSyBoCauxrpkHo3kzCHq1A_Zi9YF63OerM18:[DEFAULT]";
          const userDataString = sessionStorage.getItem(key);
          if (userDataString) {
            try {
              const userData = JSON.parse(userDataString);
              return userData;
            } catch (e) {
              console.error("Error parsing user data from sessionStorage:", e);
              return null;
            }
          }
          return null;
        }

        // Set user in Chatwoot
        function setUserInChatwoot() {
          const userData = getUserFromSessionStorage();
          if (userData && userData.email) {
            window.$chatwoot.setUser(userData.email, {
              name: userData.email, // You can replace with userData.displayName if available
              email: userData.email,
            });
            console.log("User set in Chatwoot with email: " + userData.email);
          } else {
            console.log(
              "No user data found or email is missing in sessionStorage."
            );
          }
        }

        setUserInChatwoot();
      });
    </script>
  </body>
</html>
